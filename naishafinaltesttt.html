<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HELPERBUDDY CHANDIGARH</title>
<style>
body { font-family:'Segoe UI',sans-serif; margin:0; background:#e6f0fa; color:#333; }
header { background: linear-gradient(90deg,#4a90e2,#74b9ff); color:white; padding:25px 20px; text-align:center; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
header small { display:block; font-size:14px; margin-top:4px; color:#d6e4f2; }
nav { background:#fff; padding:12px 0; text-align:center; box-shadow:0 2px 6px rgba(0,0,0,0.1); position:sticky; top:0; z-index:10; }
nav button { margin:5px 10px; padding:10px 22px; border:none; border-radius:8px; background:#74b9ff; color:white; font-weight:500; cursor:pointer; transition:0.3s; }
nav button:hover { background:#0984e3; }
nav button.logout { background:#e74c3c; }
section { display:none; max-width:750px; margin:25px auto; background:white; padding:25px; border-radius:10px; box-shadow:0 6px 15px rgba(0,0,0,0.05); transition:all 0.3s ease-in-out; }
.active { display:block; }
input, select { width:100%; padding:12px; margin:10px 0; border-radius:6px; border:1px solid #ccc; font-size:14px; }
button { background:#74b9ff; color:white; font-weight:500; border:none; cursor:pointer; }
button:hover { background:#0984e3; }
.card { background:#f4f8ff; padding:15px; margin:12px 0; border-left:5px solid #74b9ff; border-radius:8px; transition: transform 0.2s; }
.card:hover { transform: scale(1.02); }
button.verify { margin-left:10px; padding:5px 12px; background:#0984e3; color:white; border:none; border-radius:5px; cursor:pointer; }
.notice { margin-top:8px; padding:10px; border-radius:6px; background:#d6e4f2; color:#333; font-weight:500; }
footer { background:#4a90e2; color:white; text-align:center; padding:15px; margin-top:30px; border-top:4px solid #74b9ff; font-size:14px; }
#admin { background:#eaf1fb; border-left:5px solid #0984e3; }
#admin h3 { color:#0984e3; }
#adminData .card { border-left:5px solid #0984e3; background:#fff; }
#adminData h4 { color:#0984e3; }
</style>
</head>
<body>

<header>
  <h2>HELPERBUDDY CHANDIGARH</h2>
  <small>AI that helps find helpers</small>
</header>

<nav>
  <button id="navLogin">Login</button>
  <button id="navRegister">Register</button>
  <button id="navSearch" style="display:none;">Find Helper</button>
  <button id="navAdd" style="display:none;">Add Helper</button>
  <button id="navAdmin" style="display:none;">Admin Panel</button>
  <button id="navLogout" class="logout" style="display:none;">Logout</button>
</nav>

<section id="login" class="active">
<h3>Login</h3>
<input id="loginUser" placeholder="Username">
<input id="loginPass" type="password" placeholder="Password">
<button id="btnLogin">Login</button>
<div id="loginMsg" class="notice"></div>
</section>

<section id="register">
<h3>Register</h3>
<input id="regUser" placeholder="Username">
<input id="regPass" type="password" placeholder="Password">
<button id="btnRegisterAction">Register</button>
<div id="regMsg" class="notice"></div>
</section>

<section id="search">
<h3>Find a Helper</h3>
<label>Sector</label>
<select id="sector"></select>
<label>Work Needed</label>
<select id="work">
<option>Cleaning</option>
<option>Utensils</option>
<option>Babysitting</option>
<option>Household Tasks</option>
</select>
<button id="btnSearchAction">Search</button>
<div id="results"></div>
</section>

<section id="add">
<h3>Add Helper</h3>
<input id="hName" placeholder="Name">
<input id="hAge" type="number" placeholder="Age">
<input id="hPhone" placeholder="Phone">
<label>Sector</label>
<select id="hSector"></select>
<label>Work</label>
<select id="hWork">
<option>Cleaning</option>
<option>Utensils</option>
<option>Babysitting</option>
<option>Household Tasks</option>
</select>
<button id="btnAddHelper">Add Helper</button>
<div id="addMsg" class="notice"></div>
</section>

<section id="admin">
<h3>Admin Panel</h3>
<div id="adminData"></div>
</section>

<footer>
  <strong>Made by Naisha Chaudhary , Ekroop Kaur , Ira Chhikara</strong>
</footer>

<script>
// STORAGE & DATA
const K_USERS="helperbuddy_users", K_HELPERS="helperbuddy_helpers", K_LOGS="helperbuddy_logs";
let users = JSON.parse(localStorage.getItem(K_USERS)) || [{username:"admin",password:"admin123",role:"admin"}];
let helpers = JSON.parse(localStorage.getItem(K_HELPERS)) || [];
let logs = JSON.parse(localStorage.getItem(K_LOGS)) || [];
let currentUser = null;

// AUTO-VERIFY EXISTING HELPERS
helpers.forEach(h=>h.verified=true);
localStorage.setItem(K_HELPERS, JSON.stringify(helpers));

// POPULATE SECTORS
const sector = document.getElementById("sector"), hSector = document.getElementById("hSector");
for(let i=1;i<=50;i++){ sector.innerHTML+=`<option>${i}</option>`; hSector.innerHTML+=`<option>${i}</option>`; }

// NAV BUTTONS
const navLogin=document.getElementById("navLogin"), navRegister=document.getElementById("navRegister"),
      navSearch=document.getElementById("navSearch"), navAdd=document.getElementById("navAdd"),
      navAdmin=document.getElementById("navAdmin"), navLogout=document.getElementById("navLogout");

function showSection(id){ document.querySelectorAll("section").forEach(s=>s.classList.remove("active")); document.getElementById(id).classList.add("active"); }
function refreshNav(){
  if(currentUser){
    navLogin.style.display=navRegister.style.display="none";
    navSearch.style.display=navAdd.style.display=navAdmin.style.display=navLogout.style.display="inline-block";
  } else{
    navLogin.style.display=navRegister.style.display="inline-block";
    navSearch.style.display=navAdd.style.display=navAdmin.style.display=navLogout.style.display="none";
  }
}

// LOGIN
document.getElementById("btnLogin").addEventListener("click",()=>{
  const u=loginUser.value.trim(), p=loginPass.value.trim();
  const user=users.find(x=>x.username===u && x.password===p);
  if(!user){ loginMsg.innerText="❌ Invalid credentials"; return; }
  currentUser=user;
  logs.push({user:u,time:new Date().toLocaleString()});
  localStorage.setItem(K_LOGS,JSON.stringify(logs));
  refreshNav();
  loginUser.value=loginPass.value="";
  if(currentUser.role==="admin"){ showSection("admin"); renderAdmin(); } else{ showSection("search"); }
});

// REGISTER
document.getElementById("btnRegisterAction").addEventListener("click",()=>{
  const u=regUser.value.trim(), p=regPass.value.trim();
  if(!u||!p){ regMsg.innerText="❌ Fill all fields"; return; }
  if(users.some(x=>x.username===u)){ regMsg.innerText="❌ Username exists"; return; }
  users.push({username:u,password:p,role:"user"});
  localStorage.setItem(K_USERS,JSON.stringify(users));
  regMsg.innerText="✅ Registered! You can login."; regUser.value=regPass.value="";
});

// LOGOUT
navLogout.addEventListener("click",()=>{ currentUser=null; refreshNav(); showSection("login"); });

// ADD HELPER
document.getElementById("btnAddHelper").addEventListener("click",()=>{
  if(!hName.value||!hAge.value||!hPhone.value){ addMsg.innerText="❌ Fill all fields"; return; }
  helpers.push({ id:Date.now(), name:hName.value, age:+hAge.value, phone:hPhone.value, sector:hSector.value, work:hWork.value, verified:false, ratings:[] });
  localStorage.setItem(K_HELPERS,JSON.stringify(helpers));
  addMsg.innerText="✅ Helper added! Awaiting admin verification.";
  hName.value=hAge.value=hPhone.value="";
  if(currentUser.role==="admin") renderAdmin();
});

// SEARCH HELPERS
document.getElementById("btnSearchAction").addEventListener("click",()=>{
  results.innerHTML="";
  const s=sector.value, w=work.value;
  let list=helpers.filter(h=>h.sector==s && h.work==w && h.verified);
  if(list.length===0){ results.innerHTML="<b>0 helpers found</b>"; return; }
  list=list.sort(()=>0.5-Math.random()).slice(0,4);
  list.forEach(h=>{
    const avg=h.ratings.length?(h.ratings.reduce((a,b)=>a+b,0)/h.ratings.length).toFixed(1):"No ratings";
    const div=document.createElement("div"); div.className="card";
    div.innerHTML=`<b>${h.name}</b><br>Age:${h.age}<br>Phone:${h.phone}<br>Sector:${h.sector}<br>Work:${h.work}<br>⭐${avg}`;
    results.appendChild(div);
  });
});

// ADMIN PANEL
function renderAdmin(){
  adminData.innerHTML="";
  const hTitle=document.createElement("h4"); hTitle.innerText="Helpers"; adminData.appendChild(hTitle);
  helpers.forEach(h=>{
    const div=document.createElement("div"); div.className="card";
    div.innerHTML=`${h.name} (${h.work}) - Sector ${h.sector} ${h.verified?"✅":"❌"}`;
    if(!h.verified){
      const btn=document.createElement("button"); btn.innerText="Verify"; btn.className="verify";
      btn.onclick=()=>{ h.verified=true; localStorage.setItem(K_HELPERS,JSON.stringify(helpers)); renderAdmin(); };
      div.appendChild(btn);
    }
    adminData.appendChild(div);
  });
  const lTitle=document.createElement("h4"); lTitle.innerText="Login Logs"; adminData.appendChild(lTitle);
  logs.forEach(l=>{ const div=document.createElement("div"); div.className="card"; div.innerText=`${l.user} logged in @ ${l.time}`; adminData.appendChild(div); });
}

// NAV BUTTONS
navLogin.addEventListener("click",()=>showSection("login"));
navRegister.addEventListener("click",()=>showSection("register"));
navSearch.addEventListener("click",()=>showSection("search"));
navAdd.addEventListener("click",()=>showSection("add"));
navAdmin.addEventListener("click",()=>{ showSection("admin"); renderAdmin(); });
// NAV BUTTONS
navLogin.addEventListener("click",()=>showSection("login"));
navRegister.addEventListener("click",()=>showSection("register"));
navSearch.addEventListener("click",()=>showSection("search"));
navAdd.addEventListener("click",()=>showSection("add"));
navAdmin.addEventListener("click",()=>{
  if(currentUser && currentUser.role==="admin"){
    showSection("admin");
    renderAdmin();
  } else {
    alert("Access denied: Admins only!");
  }
});


refreshNav();
function refreshNav(){
  if(currentUser){
    navLogin.style.display = "none";
    navRegister.style.display = "none";
    navSearch.style.display = "inline-block";
    navAdd.style.display = "inline-block";
    navLogout.style.display = "inline-block";

    // ✅ Only admin can see admin button
    if(currentUser.role === "admin"){
      navAdmin.style.display = "inline-block";
    } else {
      navAdmin.style.display = "none";
    }

  } else {
    navLogin.style.display = "inline-block";
    navRegister.style.display = "inline-block";
    navSearch.style.display = "none";
    navAdd.style.display = "none";
    navAdmin.style.display = "none";
    navLogout.style.display = "none";
  }
}
</script>
</body>
</html>
